{"title":"Java æ•°å­—ç­¾åç®—æ³•","date":"2021-10-18T12:26:56.000Z","date_formatted":{"ll":"2021å¹´10æœˆ18æ—¥","L":"2021/10/18","MM-DD":"10-18"},"link":"java-digital-signature-algorithm","tags":["java"],"updated":"2021-10-18T04:30:09.577Z","content":"<p>æ•°å­—ç­¾åç®—æ³•å¯ä»¥çœ‹æˆæ˜¯å¸¦ç§˜é’¥çš„æ¶ˆæ¯æ‘˜è¦ç®—æ³•ï¼Œç”¨äºéªŒè¯æ•°æ®å®Œæ•´æ€§ã€è®¤è¯æ•°æ®æ¥æºï¼Œå¹¶èµ·åˆ°æŠ—å¦è®¤çš„ä½œç”¨ã€‚éµå¾ªç§é’¥åŠ ç­¾ï¼Œå…¬é’¥éªŒç­¾çš„è§„åˆ™ï¼Œæ•°å­—ç­¾åç®—æ³•æ˜¯éå¯¹ç§°åŠ å¯†ç®—æ³•å’Œæ¶ˆæ¯æ‘˜è¦ç®—æ³•çš„ç»“åˆä½“ã€‚æ•°å­—ç­¾åç®—æ³•ä¸»è¦åŒ…æ‹¬RSAå’ŒDSAã€‚è¿™èŠ‚è®°å½•ä¸‹è¿™ä¸¤ç§ç®—æ³•åœ¨JDK8ä¸‹çš„å®ç°ã€‚</p>\n<p>æ•°å­—ç­¾ååŠ ç­¾éªŒç­¾æµç¨‹åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p>\n<ol>\n<li>Aåœ¨æœ¬åœ°æ„å»ºç§˜é’¥å¯¹ï¼Œå¹¶å°†å…¬é’¥å‘å¸ƒç»™Bï¼›</li>\n<li>Aä½¿ç”¨ç§é’¥å¯¹æ•°æ®è¿›è¡Œç­¾åï¼›</li>\n<li>Aå‘é€ç­¾åå’Œæ•°æ®ç»™Bï¼›</li>\n<li>Bä½¿ç”¨å…¬é’¥å¯¹ç­¾åå’Œæ•°æ®è¿›è¡ŒéªŒç­¾ã€‚</li>\n</ol>\n<h2 id=\"rsa\">RSA<a title=\"#rsa\" href=\"#rsa\"></a></h2>\n<p>RSAæ•°å­—ç­¾åç®—æ³•ä¸»è¦åˆ†ä¸ºMDç³»åˆ—å’ŒSHAç³»åˆ—ä¸¤å¤§ç±»ã€‚MDç³»åˆ—ä¸»è¦åŒ…æ‹¬MD2withRSAå’ŒMD5withRSAå…±2ç§æ•°å­—ç­¾åç®—æ³•ï¼›SHAç³»åˆ—ä¸»è¦åŒ…æ‹¬SHA1withRSAã€SHA224withRSAã€SHA256withRSAã€SHA384withRSAå’ŒSHA512withRSAå…±5ç§æ•°å­—ç­¾åç®—æ³•ã€‚</p>\n<p>ä»£ç ç¤ºä¾‹ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.junit.Test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.security.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Base64;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RsaSignatureDemo</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">test</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        String value = <span class=\"string\">&quot;mrbird&#x27;s blog&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">// éå¯¹ç§°åŠ å¯†ç®—æ³•</span></span><br><span class=\"line\">        String algorithm = <span class=\"string\">&quot;RSA&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">// ç­¾åç®—æ³•ï¼ŒRSA+SHA</span></span><br><span class=\"line\">        String signAlgorithm = <span class=\"string\">&quot;SHA256withRSA&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// ----- å…¬ç§é’¥ç”Ÿæˆ --------</span></span><br><span class=\"line\">        <span class=\"comment\">// å®ä¾‹åŒ–ç§˜é’¥å¯¹ç”Ÿæˆå™¨</span></span><br><span class=\"line\">        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(algorithm);</span><br><span class=\"line\">        <span class=\"comment\">// åˆå§‹åŒ–ï¼Œç§˜é’¥é•¿åº¦512~16384ä½ï¼Œ64å€æ•°</span></span><br><span class=\"line\">        keyPairGenerator.initialize(<span class=\"number\">512</span>);</span><br><span class=\"line\">        <span class=\"comment\">// ç”Ÿæˆç§˜é’¥å¯¹</span></span><br><span class=\"line\">        KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br><span class=\"line\">        <span class=\"comment\">// å…¬é’¥</span></span><br><span class=\"line\">        PublicKey publicKey = keyPair.getPublic();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;RSAå…¬é’¥: &quot;</span> + Base64.getEncoder().encodeToString(publicKey.getEncoded()));</span><br><span class=\"line\">        <span class=\"comment\">// ç§é’¥</span></span><br><span class=\"line\">        PrivateKey privateKey = keyPair.getPrivate();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;RSAç§é’¥: &quot;</span> + Base64.getEncoder().encodeToString(privateKey.getEncoded()));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// ----- ç§é’¥åŠ ç­¾ ---------</span></span><br><span class=\"line\">        <span class=\"comment\">// è·å–ç­¾åå¯¹è±¡</span></span><br><span class=\"line\">        Signature signature = Signature.getInstance(signAlgorithm);</span><br><span class=\"line\">        signature.initSign(privateKey);</span><br><span class=\"line\">        signature.update(value.getBytes());</span><br><span class=\"line\">        <span class=\"keyword\">byte</span>[] sign = signature.sign();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;ç­¾åå€¼: &quot;</span> + Base64.getEncoder().encodeToString(sign));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// ----- å…¬é’¥éªŒç­¾ ---------</span></span><br><span class=\"line\">        signature.initVerify(publicKey);</span><br><span class=\"line\">        signature.update(value.getBytes());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;éªŒç­¾ç»“æœ: &quot;</span> + signature.verify(sign));</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç§˜é’¥å¯¹ç”Ÿæˆè¿‡ç¨‹å’Œä¸Šç¯‡RSAä»‹ç»çš„æ— å¼‚ï¼Œä¸»è¦å…³æ³¨åŠ ç­¾å’ŒéªŒç­¾æ“ä½œå³å¯ï¼Œç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RSAå…¬é’¥: MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAKTTlw+zyhGzmTmhT5w9vEP1ejOcVfM2rHbz8jUae7InAh42R9ZaYUk1c3q0uqmTv8xKOnszU/vrdV52zoFM+OMCAwEAAQ==</span><br><span class=\"line\">RSAç§é’¥: MIIBUwIBADANBgkqhkiG9w0BAQEFAASCAT0wggE5AgEAAkEApNOXD7PKEbOZOaFPnD28Q/V6M5xV8zasdvPyNRp7sicCHjZH1lphSTVzerS6qZO/zEo6ezNT++t1XnbOgUz44wIDAQABAkBsZQXz+p2J1J2Qq8fqDSNxYc8Sf956SttSgw0m5Rqxxiw10cgHt67uocu3qK6UeMuJuaOiN3YT48kvFp6Joc75AiEA4L7R1zDWcOdWf2BE/k3yxJ4Uv0vbIZ9vWLuJGBR3xK0CIQC7v5f2fcedBWbJ/kR7CvbFE91ivM55dvWZMe/JrjXVzwIgFUn+FqRJq+g+CVLVNkGr/XP8AyLsXwL7SSx6kA1gSwECIHysAn4VEftr/dC+Pr0yD6HYyhbp53XzD6214lQbkfYzAiB1b2wNi0Y3N+D/OIrGUHlwgA0vkX82NP3V8qMDmRbCTQ==</span><br><span class=\"line\">ç­¾åå€¼: HVN5WkhND0hy/xY43h8r3+AVt6oxMSv1Ug/Y+bv1tGxw4ePQtIgzFwK0lQQbhIlwts2d2STwQBews4dXCfEMmA==</span><br><span class=\"line\">éªŒç­¾ç»“æœ: true</span><br></pre></td></tr></table></figure>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ä¸åŒç­¾åç®—æ³•éœ€è¦çš„ç§˜é’¥é•¿åº¦æœ€å°å€¼ä¸åŒï¼Œå¤§ä¼™å¯ä»¥è‡ªå·±è¯•è¯•ã€‚</p>\n<h2 id=\"dsa\">DSA<a title=\"#dsa\" href=\"#dsa\"></a></h2>\n<p>DSAç®—æ³•ä¸RSAç®—æ³•éƒ½æ˜¯æ•°å­—è¯ä¹¦ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸¤ç§ç®—æ³•ã€‚ä¸¤è€…ä¸åŒçš„æ˜¯ï¼ŒDSAç®—æ³•ä»…åŒ…å«æ•°å­—ç­¾åç®—æ³•ï¼Œä½¿ç”¨DSAç®—æ³•çš„æ•°å­—è¯ä¹¦æ— æ³•è¿›è¡ŒåŠ å¯†é€šä¿¡ï¼Œè€ŒRSAç®—æ³•æ—¢åŒ…å«åŠ å¯†/è§£å¯†ç®—æ³•ï¼ŒåŒæ—¶å…¼æœ‰æ•°å­—ç­¾åç®—æ³•ã€‚</p>\n<p>JDK8æ”¯æŒSHA1withDSAã€SHA224withDSAã€SHA256withDSAã€SHA384withDSAå’ŒSHA512withDSAè¿™äº”ç§DSAæ•°å­—ç­¾åç®—æ³•ã€‚</p>\n<p>ä»£ç ç¤ºä¾‹ï¼ˆåªéœ€å°†ä¸Šé¢çš„ä¾‹å­ç®—æ³•æ›¿æ¢ä¸‹å°±å¥½ï¼Œå¹¶ä¸”æ³¨æ„ç§˜é’¥çš„é•¿åº¦èŒƒå›´ï¼‰ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.junit.Test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.security.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Base64;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RsaSignatureDemo</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">test</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        String value = <span class=\"string\">&quot;mrbird&#x27;s blog&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">// éå¯¹ç§°åŠ å¯†ç®—æ³•</span></span><br><span class=\"line\">        String algorithm = <span class=\"string\">&quot;DSA&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">// ç­¾åç®—æ³•ï¼ŒDSA+SHA</span></span><br><span class=\"line\">        String signAlgorithm = <span class=\"string\">&quot;SHA224withDSA&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// ----- å…¬ç§é’¥ç”Ÿæˆ --------</span></span><br><span class=\"line\">        <span class=\"comment\">// å®ä¾‹åŒ–ç§˜é’¥å¯¹ç”Ÿæˆå™¨</span></span><br><span class=\"line\">        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(algorithm);</span><br><span class=\"line\">        <span class=\"comment\">// åˆå§‹åŒ–ï¼Œç§˜é’¥é•¿åº¦512~1024ä½ï¼Œ64å€æ•°</span></span><br><span class=\"line\">        keyPairGenerator.initialize(<span class=\"number\">1024</span>);</span><br><span class=\"line\">        <span class=\"comment\">// ç”Ÿæˆç§˜é’¥å¯¹</span></span><br><span class=\"line\">        KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br><span class=\"line\">        <span class=\"comment\">// å…¬é’¥</span></span><br><span class=\"line\">        PublicKey publicKey = keyPair.getPublic();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;DSAå…¬é’¥: &quot;</span> + Base64.getEncoder().encodeToString(publicKey.getEncoded()));</span><br><span class=\"line\">        <span class=\"comment\">// ç§é’¥</span></span><br><span class=\"line\">        PrivateKey privateKey = keyPair.getPrivate();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;DSAç§é’¥: &quot;</span> + Base64.getEncoder().encodeToString(privateKey.getEncoded()));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// ----- ç§é’¥åŠ ç­¾ ---------</span></span><br><span class=\"line\">        <span class=\"comment\">// è·å–ç­¾åå¯¹è±¡</span></span><br><span class=\"line\">        Signature signature = Signature.getInstance(signAlgorithm);</span><br><span class=\"line\">        signature.initSign(privateKey);</span><br><span class=\"line\">        signature.update(value.getBytes());</span><br><span class=\"line\">        <span class=\"keyword\">byte</span>[] sign = signature.sign();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;ç­¾åå€¼: &quot;</span> + Base64.getEncoder().encodeToString(sign));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// ----- å…¬é’¥éªŒç­¾ ---------</span></span><br><span class=\"line\">        signature.initVerify(publicKey);</span><br><span class=\"line\">        signature.update(value.getBytes());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;éªŒç­¾ç»“æœ: &quot;</span> + signature.verify(sign));</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DSAå…¬é’¥: MIIBtzCCASwGByqGSM44BAEwggEfAoGBAP1/U4EddRIpUt9KnC7s5Of2EbdSPO9EAMMeP4C2USZpRV1AIlH7WT2NWPq/xfW6MPbLm1Vs14E7gB00b/JmYLdrmVClpJ+f6AR7ECLCT7up1/63xhv4O1fnxqimFQ8E+4P208UewwI1VBNaFpEy9nXzrith1yrv8iIDGZ3RSAHHAhUAl2BQjxUjC8yykrmCouuEC/BYHPUCgYEA9+GghdabPd7LvKtcNrhXuXmUr7v6OuqC+VdMCz0HgmdRWVeOutRZT+ZxBxCBgLRJFnEj6EwoFhO3zwkyjMim4TwWeotUfI0o4KOuHiuzpnWRbqN/C/ohNWLx+2J6ASQ7zKTxvqhRkImog9/hWuWfBpKLZl6Ae1UlZAFMO/7PSSoDgYQAAoGAcW0aiebAWi5M18Lu6QS/1OoHbtw2I7kyivwExbNAZpWR9I9sNIwE1T0a491t1oqRV1cdBHyd9jiJqFwfLG6k5QidasXTgGYSsSZqFBebP5nrF5q3RtkosoHeHVKDnShQf5b36NK53CpCRfLayk2e5inu7CCCo+a58piAMiF3c+k=</span><br><span class=\"line\">DSAç§é’¥: MIIBTAIBADCCASwGByqGSM44BAEwggEfAoGBAP1/U4EddRIpUt9KnC7s5Of2EbdSPO9EAMMeP4C2USZpRV1AIlH7WT2NWPq/xfW6MPbLm1Vs14E7gB00b/JmYLdrmVClpJ+f6AR7ECLCT7up1/63xhv4O1fnxqimFQ8E+4P208UewwI1VBNaFpEy9nXzrith1yrv8iIDGZ3RSAHHAhUAl2BQjxUjC8yykrmCouuEC/BYHPUCgYEA9+GghdabPd7LvKtcNrhXuXmUr7v6OuqC+VdMCz0HgmdRWVeOutRZT+ZxBxCBgLRJFnEj6EwoFhO3zwkyjMim4TwWeotUfI0o4KOuHiuzpnWRbqN/C/ohNWLx+2J6ASQ7zKTxvqhRkImog9/hWuWfBpKLZl6Ae1UlZAFMO/7PSSoEFwIVAIv03r5wR+DolDC5bGFOqQ2vuHlo</span><br><span class=\"line\">ç­¾åå€¼: MCwCFBRba/HI5/tLt+exzpgvLoq5mAwaAhQvaVv4dbGFNtMpcI4ZeqjgAGeGyg==</span><br><span class=\"line\">éªŒç­¾ç»“æœ: true</span><br></pre></td></tr></table></figure>\n","prev":{"title":"æµ‹è¯•ä»£ç è¯­æ³•é«˜äº®","link":"b5cb8be0"},"next":{"title":"ioasnfoniofnais","link":"3fa6e885"},"plink":"http://www.chenyuxi.top/java-digital-signature-algorithm/","toc":[{"id":"rsa","title":"RSA","index":"1"},{"id":"dsa","title":"DSA","index":"2"}],"copyright":{"author":"é™ˆäºˆå¸Œ","link":"<a href=\"http://www.chenyuxi.top/java-digital-signature-algorithm/\" title=\"Java æ•°å­—ç­¾åç®—æ³•\">http://www.chenyuxi.top/java-digital-signature-algorithm/</a>","license":"æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a> è®¸å¯åè®®ã€‚æ¬¢è¿è½¬è½½ï¼Œä½†è¯·æ³¨æ˜å‡ºå¤„ï¼ğŸ¤—"}}